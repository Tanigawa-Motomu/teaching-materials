## 4.4 Ruby on Rails：Webシステム概念

### 4.4.1 インターネットの概要

インターネットとは、TCP/IPというプロトコルを利用して、コンピュータや、スマートフォン等ネットワーク機能を内蔵した電子機器で構成されるネットワークです。

そのネットワーク上で、電子メールでのテキストの送受信、スマートフォンで撮影したデジタル画像の送受信、WWW、SNSでの情報交換、クラウドサービスの利用等ができます。

機器の接続には、有線と無線(WiFi等)があり、一般的にインターネットに接続している機器は、異なるIPアドレスを持ち、自分と相手を特定して通信を行います。

インターネットは、プライベートのネットワークではありません。大勢の人の努力の結果、インターネットに接続することで、地球の裏側にあるインターネットに接続されている機器やサービスとも接続をすることができます。つまり、インターネットはひとかたまりのネットワーク(The Internet)です。

インターネット上で提供されているサービスには、自分を証明するアカウントを持たなくても利用できるサービスと、アカウントが必要なサービスがあります。

どちらの場合でも、サービスを提供する側はセキュリティを考慮する必要があります。

セキュリティを考慮しないと、たとえば、だれでも利用できるサービスの場合は、提供している文字や画像、動画、プログラム等を提供者の意図と異なるものに差し替えられる等が考えられます。また、アカウントが必要なサービスの場合は、アカウント名やパスワードを盗まれて、秘密であるはずの情報が第三者に閲覧、取得されてしまうこと等が考えられます。ですので、インターネットに接続するサービスでは、提供するコンテンツへのアクセス権や、暗号化、2段階認証等の技術を利用してセキュリティを十分考慮する必要があります。

### 4.4.2 HTTPプロトコルとWebサーバの概要

インターネットで利用できるサービスは、いろいろありますが、ここでは、特にWebサービスの構成に利用されるプロトコル、HTTPについて解説します。

一般にHTTPは、HTTPサーバー(Webサーバー)とHTTPクライアント(Webブラウザ)間で利用されます。

HTTPサーバーは、HTTPクライアントからテキストのリクエスト、画像のリクエスト、画像の登録等のリクエストがあるのを待機しています。一般的にTCP/IPの80番ポートが利用されます。

HTTPクライアントは、利用したいサーバーのTCP/IPの80番ポートをめがけてリクエストをします。

たとえば、Googleに接続してサービスを利用したい場合はWebブラウザのアドレス欄に、http://www.google.co.jp と入力します。

一般的にHTTPサーバとの通信は80番ポートを使うことになっているので、HTTPクライアントでポート番号を省略すると80番ポートとして動作します。

つまり、http://www.google.co.jp:80 と入力したのと同じです。

ただし80番ポートはデータ通信をする際に暗号化されないので、秘密にしたい情報のやりとりには向きません。その場合は、セキュアなプロトコルSSL/TLSで保護された通信を利用します。一般的にHTTPSでの通信は443番ポートが利用されます。

こちらは、https://www.google.co.jp と入力します。https://www.google.co.jp:443 と入力したのと同じです。

ただし、実際には 

http://www.google.co.jp と入力すると、googleのHTTPサーバのポリシーによって、セキュアな接続を利用するように 

https://www.google.co.jp へリダイレクト(転送)されるサービスもあります。



HTTPサーバーはHTTPクライアントからリクエストを受け付けると、HTTPクライアントの画面に表示される文字情報、画像、音声、動画等目に見える情報(HTMLやPNG,MP4等)と、それらを配置するレイアウト情報(CSS)、HTTPクライアント側で動作するプログラム(JavaScript)等を要求のあったクライアントに向けて返信します。

1つのサーバーが同時に複数のリクエストを受け付けても、リクエストをしたHTTPクライアントには固有のIPアドレスが割り当てられていて、そのIPアドレスも含めてリクエストするので、それぞれのHTTPクライアントのリクエストに応じた適切な内容を返信します。

HTTPは、リクエストへの返信が完了すると、一旦、HTTPクライアントとの接続を切断します。つまり、次に同じHTTPクライアントからリクエストがあっても、以前にリクエストされたHTTPクライアントと同一なのか判断できません。

このままでは、ショッピングサイトで、買い物をしようと商品をカートに入れても、別の商品をカートに入れる際、最初のカートの情報がわからなくなってしまい、いつまでもレジに進むことができません。

そこで、セッション管理機能を使うことで、HTTPサーバーが最初のリクエストを受け付けた時に、HTTPクライアントに返信するデータにセッション情報を含めて、次のHTTPクライアントからのリクエストには、そのセッション情報も含めてもらうことで、別の商品をカートに入れる際も、最初のカート番号が識別できるようになります。

### 4.4.3 Webブラウザ、HTML,JavaScriptの概要

HTTPクライアントは、Webブラウザとも呼ばれます。Webブラウザの一例として、Internet Exploer, Chrome, Firefox, Safari等があります。

Webブラウザには、HTTPサーバにリクエストを送信する機能、返信された文字や画像等のコンテンツを受信して、定義されているレイアウトに応じてコンテンツを配置する機能、動画や音声を再生する機能、JavaScriptで記述されたWebブラウザ側で動作するプログラムを実行する機能、パソコンやスマートフォンのカメラやマイクを利用する機能等があります。

また、セキュアな接続が必要な場合は、その接続先が信頼できるか確認したり、暗号化した通信をする機能も含まれます。

HTML,CSS,JavaScriptを含んだコンテンツの例:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>HTMLの例</title>
    <script>
        function hi() {
            alert("Hi!");
        }
    </script>
    <style>
        .red {
            color: #FF0000;
        }
    </style>
</head>
<body>
    <div class="red">
        <p>HTMLの例</p>
        <input type="button" value="ボタン" onclick="hi()">
    </div>
</body>
</html>
```

(a) HTML

HTTPのリクエストに対する応答の本文です。

`<body>`と`</body>`のようにタグと呼ばれる文字を利用しながらコンテンツの内容、構造を記述します。タグの中にタグを含めることができます。

(b) CSS

上記の例では`<style>`タグに記述していますが、別のファイルに記述することが多いです。CSSは主にコンテンツの装飾を担います。

コンテンツの装飾はわざわざCSSに分けなくても記述できますが、コンテンツ本体と装飾が混在した状態では記述内容が分かりにくいこと、HTMLに含まれるコンテンツの再利用がしづらいこと等の理由から、現在は分割するスタイルが主流です。

(c) JavaScript

Webブラウザ側で動作させることができるプログラム言語です。

上記の例では`<script>`タグにプログラムを記述し、ボタンをクリックしたらJavaScriptのプログラムを実行しています。

例にはありませんが、変数も使用できますし、functionで様々なメソッド(処理のかたまり)を作成して、WebブラウザからHTTPサーバーへ送信するリクエストの内容を確認したり、入力するデータの補助機能を記述したり、音や画像を使ったゲームを記述することもできます。
