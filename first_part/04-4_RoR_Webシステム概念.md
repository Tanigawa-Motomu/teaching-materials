## 11 Ruby on Rails：Webシステム概念

## 目次

- [webシステムの基本的な知識](#webシステムの基本的な知識)  
  - [webシステムとは？](#webシステムとは？)
  - [サーバーとクライアントの関係](#サーバーとクライアントの関係)
  - [webシステムとは？](#webシステムとは？)


## webシステムの基本的な知識

### Webシステムとは？

<br>

__【Webシステムとは】__   
   - **インターネット**を利用して、**Webブラウザ**（例えば、Google ChromeやSafariなど）で利用できるシステムとサービスやアプリケーションの事です。  

   <br>

   - **インターネット**に接続されたネットワーク機能を持つ電子機器とWebブラウザがあれば、どこからでもアクセスできます。

<br>

**<u>Webシステムには、大きく分けてWebサイトとWebアプリケーションがあります</u>。**

   - **Webサイト**   
   基本的に、ページを閲覧することが中心です。    
   情報提供を主な目的とするもので、例えば企業や個人のホームページ、ニュースサイト、ブログ、ウィキペディアなどがあります。
  
  <br>

   - **Webアプリケーション**  
    ユーザーが操作を行い、特定の機能を使うことができるシステムです。  
    例えばオンラインショッピングサイトやSNS、Google検索などがこれに当たります。
  

#### **これらはすべて、インターネットを通じて利用できるシステムです**。

***

### サーバーとクライアントの関係
**<u>Webシステムでは、サーバーとクライアントという2つの重要な役割が存在します。</u>**

__【サーバーとは】__  

- `サーバー`とは、**Webシステムでデータを提供する役割を担うコンピュータです**。  
インターネットを通じて、ユーザーがリクエストしたWebページやアプリケーションのデータ、画像、動画などを返します(レスポンス)。  
例えば、Webサーバーに保存されているWebページをリクエストすると、そのページの内容が私たちユーザーに送られます。

<br>

__【クライアントとは】__  

- `クライアント`とは、**情報を要求する側であり、私たちユーザーです**。  
Webブラウザ（Chrome、Safariなど）を使用して、Webサーバーに「このページを見せてください」とリクエストを送り、サーバーから返ってきたデータを表示します。  
クライアントの役割は、サーバーからの情報を受け取り、それを画面に表示したり、ユーザーの入力に基づいてサーバーに再度リクエストを送ったりすることです。

<br>

サーバーが提供するデータをクライアントがリクエストし、  
クライアントがそれを表示するという形で、両者は役割分担をしてお互いに連携しています。  
**このように、Webシステムはサーバーとクライアントの間でのデータのやり取りを通じて機能します**。

***

### インターネット概要

__【インターネットとは】__  
- `インターネット`とは、<u>TCP/IP(プロトコル)</u>などを使用し、コンピュータやスマートフォンなど、ネットワーク機能を持つ電子機器で構成されるネットワークです。  
このネットワークを通じて、様々なサービスなどを利用することができます。  
**※基本的には、インターネット上で情報をやり取りするための仕組みとして**、<u>**TCP/IP(プロトコル)**</u>という通信のルールが使われています。
    <details>
    <summary>ルール（プロトコル）の歴史</summary>  
    <br>
    昔は、コンピュータやネットワーク機器同士が通信するための共通のルールがなく、同じメーカーの機器同士でしかデータをやり取りできませんでした。  
    そのため、異なるメーカーの機器を使ったり、大きなシステムを拡張するのが難しかったのです。  

    <br>

    しかし、通信のルール（プロトコル）が標準化されたことで、異なるメーカーの機器でも問題なく通信できるようになりました。<br>
    特にインターネットの普及により、TCP/IPという標準的なルールが広まり、さまざまな機器やシステムがつながるようになったのです。  
    これにより、ネットワークやシステムの規模が大きくなり、より多くの技術が共存できるようになりました。

    ---

    </details>

<br>

インターネットに接続することで、遠く離れた場所にあるインターネットに接続されている機器やサービスとも接続をすることができます。   
これは個人ネットワークではなく、世界中の多数のコンピュータや機器がつながる**世界規模で動作している大規模なネットワーク（The Internet）だからです。**  

**インターネットは便利で多くの情報を提供してくれますが、その<u>規模の大きさから</u>、セキュリティにも十分な配慮が必要です**。  
<br>

次に、**インターネットのセキュリティについて説明します**。

<br>

### インターネット上で提供されるサービスのセキュリティ

インターネット上で提供されるサービスには、<u>アカウントを持たなくても利用できるサービス</u>と、<u>アカウントが必要なサービス</u>があります。  
どちらの場合でも、サービス提供者は利用者のデータやサービスの安全性を守るため、**セキュリティ対策を講じる必要があります**。

### **<u>セキュリティが不十分な場合に起こりうるリスク</u>**

- アカウントが必要なサービスでは、ユーザー名やパスワードが不正に取得されると、個人情報や機密情報が第三者に漏洩するリスクがあります。  
例えば、パスワードクラッキングやフィッシング攻撃により、アカウントが乗っ取られることがあります。

<br>

- また、アカウントを持たないサービスでは、コンテンツの改ざんや不正アクセスのリスクがあります。  
例えば、公開ページされているページの文字や画像、動画が悪意を持った第三者によって変更され、サービス内容が不正に改ざんされる<u>可能性があります</u>。

<br>

### **<u>セキュリティ対策をしっかり行おう</u>**
これらのリスクを防ぐためには、**以下のセキュリティ対策が必要です**。

1. アクセス制御：サービスにアクセスできる権限を制限する。  

1. 暗号化：SSL/TLSを利用して、通信やデータを暗号化して第三者からの盗聴や改ざんを防ぐ。  

1. 二段階認証（2FA）：パスワードに加えて、認証アプリやSMSコードを使用し、不正アクセスを防止する。  

1. セキュリティチェックを定期的に実施: サービスを使い続ける中で、定期的にセキュリティのチェックを行うことも大切です。  


#### インターネットでサービスを安全に提供するためには、これらのセキュリティ対策をきちんと実施することが大切です。<br>そして、<u>サービスを提供する側だけでなく、利用者も自分の情報を守る意識を持ち、注意を払うことが重要です</u>。

***

### プロトコルについて
__【プロトコルとは】__   
`プロトコル`とは、<u>**コンピュータやネットワーク機器同士が通信するための共通の「ルール」です。**</u>  
これにより、異なる機器やシステムが問題なくデータをやり取りできるようになります。  
また、インターネットのセキュリティは、サービスの種類に応じて異なる対策が必要です。  
情報の暗号化や認証強化、アクセス制御などが重要ですが、これらを実現するために欠かせないのが「<u>**プロトコル**</u>」です。

例えば、オンラインで重要な情報を送信する際、データを「暗号化」して、第三者に見られないようにします。  
この暗号化のルールもプロトコルに基づいて行われるため、通信の安全性が保たれます。

**<u>プロトコル</u>**は、このように<u>インターネット上でデータを守るために重要な役割を果たしています</u>。

**さまざまなルール（プロトコル）があり、用途に応じて使い分けられます。今回は、先ほど紹介したインターネットでよく使われる<u>TCP/IP</u>について見ていきます**。


### TCP/IPとは？

<u>**TCP/IP**</u>は、世界で最も使用されているプロトコル群であり、事実上、**インターネット通信での標準の仕組みとなっています**。<br>

**インターネットやローカルネットワークでデータ送受信のための基本的なルールです**。

<details><summary>ローカルネットワークついて</summary>
<br>
インターネットとは違い家庭やオフィスなどの限られた範囲で使用されるネットワークです。  
   
例えば、自宅のWi-Fiを使って、パソコンやスマートフォン、プリンターなどがつながっている状態です。  
このネットワーク内で、ファイルを共有したり、プリンターを使ったりできます。
  
ローカルネットワークは、インターネットに接続するための「接続機器（ルーターやモデム）」を使います。  
これにより、インターネットが無くても、同じネットワーク内で機器同士の通信は可能です。

---

</details>
<br>

この仕組みは、インターネットを利用するための「**共通のルール**」として、異なるコンピュータやスマートフォン、ネットワーク機器が問題なくデータをやり取りできるようにしています。

**そして、TCP/IPは以下の4つの階層に役割を分類しており、それぞれが異なる目的を持っています。このように役割を分けることで、機能の目的を分かりやすくしています。**

| 層 | 名称 | 役割 | 例 | プロトコル |
|:--|:--|:--|:--|:--|
| 4層 | アプリケーション層 | ユーザーが使うアプリケーションが通信するためのルールを決めます。| Webサイトを見る、メールを送る |  HTTP、SMTP、FTP、DNS |
| 3層 | トランスポート層 | データが途中で失われたり、遅延したりしないように管理します。<br>もしデータが届かない場合、再送信して確実に伝えます。| オンライン会議で音声が途切れないようにする| TCP、UDP |
| 2層 | インターネット層 | データがどの経路を通って送られるかを決め、目的地に届くようにします。| 的地の住所を確認して、正しい場所に届ける | IP、ICMP |
| 1層 | ネットワークアクセス層 | データが物理的に送られる部分で、Wi-Fiや有線ネットワークを使ってデータが伝送されます。 | データが通る道路やケーブル、電波 | イーサネット、Wi-Fi、PPP |

<br>

**TCP/IPの各層の役割を紹介します。**

### ｜1.アプリケーション層

__【アプリケーション層とは】__  
`アプリケーション層`とは、ユーザーが直接使用するソフトウェア（ウェブブラウザ、メールソフトなど）とネットワークとの間でデータをやり取りするための層です。
ここでは、**<u>データの内容がどのようなもので、どのようにやり取りするかが決まります</u>**。

**主なプロトコル: HTTP（ウェブ）、SMTP（メール送信）、FTP（ファイル転送）、DNS（ドメイン・ネーム・システム）など**。

**処理の流れ**  
* アプリケーション層では、ユーザーが操作するアプリケーションからデータが生成されます。  
* 例えば、ウェブサイトを表示するためにHTTPプロトコルが使われ、ユーザーが送信するメールはSMTPプロトコルを使って送信されます。  

***

### ｜2.トランスポート層

__【トランスポート層とは】__  
`トランスポート層`とは、アプリケーション層で生成されたデータが正しく相手に届くように管理する層です。<br>
ここでは、**<u>データが途中で失われたり順番が狂ったりしないようにする役割を持っています</u>**。

**主なプロトコル: TCP（Transmission Control Protocol）、UDP（User Datagram Protocol）**。

**処理の流れ** 

**TCP** 
   * データを小さく分けて送信し、受信側で順番通りに再構成します。  
   * もし途中でデータが失われた場合、再送信を要求して正確にデータを届けます。  

**UDP** 
   * データを分けて送信しますが、確認や再送は行いません。  
   * 軽量で高速な通信が求められる場合に使われます（例：オンラインゲームや動画ストリーミング）。

***

### ｜3.インターネット層

__【インターネット層とは】__  
`インターネット層`とは、データがどの経路を通って目的地に届けられるかを決める層です。  
**ここでは、送信元から受信先までデータがどのルーターを通るかを判断して、最適なルートで届けられます。**。

**主なプロトコル: IP（Internet Protocol）、ICMP（Internet Control Message Protocol）**。

**処理の流れ**  
* インターネット層では、データに宛先IPアドレスを付加し、目的地に向けて送信されます。  
* 途中のルーターを通過する際に、データが最適な経路を選ばれて転送されます。  
* IPは、データの宛先を基に経路を決定し、データを次のネットワークに送ります。  

<details>
<summary>ルーターについて</summary>

**ルーター**は、ネットワーク同士を繋げる機器で、データを送り先に適切に届ける役割を担っています。  
データに宛先となるIPアドレス（インターネット層のプロトコル（主にIP））が付けられ、ルーターはそのIPアドレスを基にデータの経路を決めます。
ルーターがデータを適切なネットワークに転送し、最終的に目的地に到達するようにします。
</details>


***

### ｜4.ネットワークアクセス層

__【ネットワークアクセス層とは】__  
`ネットワークアクセス層`とは、データを実際に物理的なネットワークで送信する層です。  
**ここでは、データを伝送するための「道」や「電波」を提供します**。

**主なプロトコル: イーサネット、Wi-Fi、PPP（Point-to-Point Protocol）**。

**処理の流れ**  
* この層では、ネットワークの物理的なメディア（有線や無線）を通じて、データが送信されます。  
     (例えば、Wi-Fiで接続されている場合、無線電波を使ってデータを送受信します。)  
* この層では、ネットワーク内の機器同士で直接データを送受信し、通信を可能にします。  

***

 **TCP/IPの仕組みでは、データがアプリケーション層からネットワークアクセス層へ、**  
 **そしてネットワークアクセス層から相手に届くまで、各層がそれぞれの役割を果たします。**  
**これらの層で使用されるプロトコルは、通信の実現において非常に重要です。**

 次に、上記で紹介したプロトコルの中で、特に重要でよく使われるものについて詳しく説明します。

 <br>

 ***

### **HTTP/HTTPS**
***
__【HTTP/HTTPSとは】__  
`HTTP/HTTPS` とは、ウェブブラウザ（クライアント）とウェブサーバが通信するための仕組み（プロトコル）です。  
このプロトコルはウェブサイトを表示するために使われますが、最も大きな違いは 通信が安全かどうか です。  

私たちは普段、「 http://www.xxxx.xxxx/ 」 のような**URL**を見かけますが、  
先頭部分にある「http://」や「https://」が、通信が暗号化されているかどうかを示しています。  


- HTTP は、データを暗号化せずにそのまま送受信します。

<br>

- HTTPS は、通信を 暗号化 して行います。これにより、第三者がデータを盗み見ることが難しくなります。

<br>

**暗号化されるのは、例えば以下のような情報です**  
- ログイン情報（ユーザー名やパスワード）

<br>

- 個人情報（名前、住所、電話番号など）

<br>

- クレジットカード情報（カード番号、期限など）

<br>

- その他の送信されるデータ（メッセージや入力内容など）

<br>

**<u>「http://」はHTTPです。</u>  <u>「https://」はHTTPSです。</u>**  
HTTPSでは、データの安全性を守るために SSL または TLS という技術を使っています。  
この技術はデータを暗号化してやり取りする仕組みで、インターネット上でのやり取りが安全であることを確保します。

**簡単に言えば、<u>HTTPS</u> は <u>HTTP</u> よりもセキュリティが高く、個人情報やパスワードを入力する際などに使われることが多いです。**

<details>
<summary>SSLついて</summary>
<strong>SSL（Secure Sockets Layer）</strong> は、インターネット上で安全に通信するための技術です。    
データを暗号化し、通信の途中でデータが盗まれたり改ざんされたりするのを防ぎます。

</details>

<details>
<summary>TLSついて</summary>
<strong>TLS（Transport Layer Security）</strong> は、SSLの後継として使われる技術で、より安全性が高いです。  
現在、実際に使用されているのはほとんどがTLSですが、一般的には「SSL」と呼ばれることもあります。
</details>

***

### **FTP**
***
__【FTPとは】__  
`FTP`とは、ファイルを転送するための通信規格です。  
**クライアント**と**サーバ**間で、ファイルのアップロードやダウンロードを行うときに使用されます。

例えば、ウェブサイトを作るとき、画像やテキストなどのファイルをウェブサーバにアップロードする必要があります。  
そのために、<strong>FTPソフト（例えば「FileZilla」など）</strong>を使います。<u>FTPソフトは、コンピュータとサーバを繋げて、ファイルを簡単に送るためのツール(アプリ)です。</u>

データの安全性を守るための仕組みもあります。  
通常のFTPは、データを暗号化せずに送信しますが、FTPS や SFTP という方法を使うと、データが暗号化され、より安全にファイルを送受信できます。  

**これにより、インターネットを介した通信が他人に見られにくくなり、情報の漏洩を防ぐことができます。**

<details>
<summary>FTPSついて</summary>

**FTPS (FTP Secure)**
は、FTPに暗号化を加えたもので、より安全にデータを転送するための技術です。  
FTPSでは、HTTP/HTTPSで説明を触れたSSL/TLSを使って通信を暗号化します。

</details>

<details>
<summary>SFTPついて</summary>

**SFTP (SSH File Transfer Protocol)** 
は、FTPとは異なるSSHという技術を使用して、ファイル転送を暗号化して行います。  
これにより、より安全な通信が可能になります。SFTPも安全性の高いプロトコルとして広く利用されています。  
※SSHは、安全なリモート接続を提供する技術で、インターネット経由でサーバに安全にアクセスするために使われます。

</details>

***
### **IP**
***
__【IPとは】__  
`IP`とは、インターネット上でコンピュータやデバイスを識別するための番号で、これを「**<u>IPアドレス</u>**」と呼びます。<br>
これは、**インターネットの「住所」のようなもので**、数字の組み合わせ（例えば「192.168.0.1」）で表されます。この番号を使って、特定の場所にアクセスできます。

普段私たちが見るのは「 https://www.google.com/ 」 のようなウェブサイトの名前で、これを「**<u>ドメイン</u>**」と呼びます。  
**ドメイン**名は、実際の住所（**IPアドレス**）をわかりやすくしたものです。

例えば、ブラウザのアドレスバーに「172.217.26.228」と入力すると、Googleのページが表示されます。この数字がGoogleのIPアドレスです。
普段は「www.google.com」などの名前を使ってウェブサイトにアクセスしますが、その名前が指し示すIPアドレスに繋がっていることになります。  
<br>
※「172.217.26.228」は2025年1月時点でのGoogleのIPアドレスです。

***

### **TCP**
***
__【TCPとは】__  
`TCP`とは、データ通信で正確に情報を渡すためのプロトコルです。  
**TCP**では、データを送る前にまず通信をする準備を整え、その後、データを送信します。  
<br>
**<u>これにより、データが正しい順序で届き、データが欠けることなく送られることが保証されます。</u>**  
もし途中でデータが失われた場合でも、TCPは再送信を行い、正確にデータを届けます。

**<u>例えばこのような場面で使用されます。</u>**

- ウェブサイトの閲覧：ブラウザがウェブページを表示する際に、画像やテキストなどのデータを正確に受け取るためにTCPが使われます。

<br>

- ファイルのダウンロード：例えば、ファイルをインターネットからダウンロードする際にも、TCPがデータの順番や欠落を防ぎ、正確にファイルを受け取ります

<br>

- メールの送受信：メールを送信したり受信したりする際にも、TCPが使われ、メッセージが正確に届くようにします。

<br>

**TCPは、データが確実に届くことを優先するため、通信の正確性が重要な場面で特に役立ちます**。

***

### **UDP**
***
__【UDPとは】__  
`UDP`とは、データを速く送るためのプロトコルです。  
**<u>TCPと違って、データを送る前に接続を作ることなく、すぐにデータを送信します。</u>**

**ただし、<u>UDPはデータがちゃんと届いたかどうかを確認したり、もし途中でデータが失われた場合に再送することはありません</u>**。  
これにより、通信が軽くて速いですが、その分、データが届かないこともあります。

例えばこのような場面で使用されます：  

- 音声通話（例：SkypeやZoom）

<br>

- 動画ストリーミング（例：YouTube）

<br>

- オンラインゲーム（例：リアルタイムの対戦ゲーム）

<br>

これらの場面では、**リアルタイムでデータを送る必要があるため、少しのデータが欠けても大きな影響がなく、すぐに次のデータが届くことで、通信が途切れずにスムーズに行えます。**

***

### **DNS**
***
__【DNSとは】__  
`DNS（ドメインネームシステム）`とは、ドメイン名を対応するIPアドレスに変換する仕組みです。

例えば、ウェブサイトにアクセスする際、「www.example.com」のようなドメイン名を入力すると、**DNS**がそれを対応するIPアドレスに変換し、目的のウェブサイトに接続します。  
これにより、ユーザーはIPアドレスを直接覚えたり入力したりする必要はなく、簡単にサイトにアクセスできます。

**<u>インターネット上には膨大な数のドメイン名とIPアドレスが存在しているため、DNSが重要な役割を果たしています。</u>**

***

**TCP/IPという仕組みは、インターネットをはじめとするコンピュータネットワークにおける通信の基盤となる設計図です。**

**通信を行う際に必要なプロトコルを層ごとに分けて構築し、効率的かつ安全にデータの送受信を可能にします。**  
**この仕組みによって、異なる機器やネットワークが互換性を持ち、スムーズなデータ通信が可能となり、私たちがインターネットを使う際の基盤を支えています。**

**ですがTCP/IPだけではデータを目的の場所に届ける事はできません。**  
データをどこの届けるべきなのかの目的地を決めるためにポート番号が必要になります。   

**次にデータを受け渡すために必要なポート番号について説明します。**

***

## ポート番号とは？

**【ポート番号とは】**    
`ポート番号`とは、IPプロトコルの説明であったIPアドレスと組み合わせて使用され、IPアドレスが「住所」のようなものであるなら、**ポート番号はその住所の「丁目、番地、号、部屋番号」にあたります**。もしこの情報が間違っていたり、欠けていたりすると、注文した商品が届かないのと同じように、データが正しい場所に届かなくなります。ポート番号は、その問題を解決して、データを正しい場所（システム、サービス、アプリケーション）に届けるために必要な情報です。 

### ポート番号の基本的な仕組み

***

* ポート番号の範囲 : 0から65535までの数値があり0から1023が使用用途が決まっていたりなど合計で三つの用途で分けられます。  
<br>
     1. ウェルノウンポート（Well-Known Ports）
        * 範囲 : 0～1023
        * **使用用途**   
        この範囲のポート番号は、「通信方法（プロトコル）」に割り振られた決まっている数値です。
     1. 登録済みポート（Registered Ports）
        * 範囲 : 1024～49151
        * **使用用途** 
        特定のアプリケーションやサービス、システムなどで利用するための数値です。 
     1. 動的またはプライベートポート（Dynamic/Private Ports）
        * 範囲 : 49152～65535
        * **使用用途**  
        一時的なポート番号として使用され、特定のアプリケーションに固定されることはありません。  
        主に、クライアントとサーバ間で行われる通信の際に動的に割り当てられる数値です。  
        通信を開始する際、クライアント側が一時的にこのポート番号を使用します。

**このように、ポート番号は通信の目的や役割に応じて異なる範囲が設定されており、それぞれの範囲に適した使い方があります。**

### 主なポート番号

* ポート番号一例
   1. ポート80 (HTTP)
      * 使用例： ウェブサーバーでのHTTP通信
      * 説明： ウェブサイトを表示するためのポート番号です。  
         通常、ウェブブラウザでURLに「http://」と入力した際に、サーバはポート80で通信を待機しています。

   1. ポート443 (HTTPS)
      * 使用例： ウェブサーバーでのHTTPS通信
      * 暗号化されたHTTP通信のためのポート番号です。

   1. ポート21 (FTP)  
      * 使用例： ファイル転送（FTPサーバー）  
      * 説明： ポート21は、FTPサーバが通信を受け入れるために使用されます。

   1. ポート53 (DNS)
      * 使用例： ドメイン・ネーム・システム（DNS）
      * 説明： ポート53は、DNSサーバとクライアントが通信する際に使用されるポート番号です。

 * サービス、システムなどでの一例
   1. ポート3306 (MySQL)
      * 使用例： MySQLデータベースの通信
      * 説明： MySQLは、広く使われているリレーショナルデータベース管理システムです。  
      ポート3306は、MySQLサーバとクライアントがデータをやり取りするために使用されるデフォルトのポート番号です。
   1. ポート3389 (RDP)
      * 使用例：リモートデスクトップ接続（RDP） 
      * 説明： RDP（Remote Desktop Protocol）は、リモートデスクトップ接続を提供するプロトコルです。  
      ポート3389は、Windowsのリモートデスクトップサービスで使用されます。

**上記のようにポート番号は用途によって決められた数値が使用されています。**

**次にポート番号の処理サイクルを説明します。**

1. クライアント（私たち）がサーバに接続したいとき
   * 例えば、ウェブサイトを見たいとき、ブラウザ（ChromeやFirefoxなど）がインターネットに接続します。   

   * ブラウザは、コンピュータの「動的ポート番号」という一時的な番号を使って、サーバ（例えばGoogleなど）に接続を試みます。この番号は毎回変わり、特定のサービスなどと結びついていません。

1. サーバは「ポート」を待機している

   * サーバは「ウェブサイトを表示するためのポート番号」を待機しています。たとえば、ウェブサイトを表示するために、サーバは通常「80番」ポートを使っています( http:// で送られて来るのを待ってる)。

   * サーバは常に決まったポート番号で「待機」しており、クライアントが接続したいときに、接続を受け入れます。

1. TCP接続の確立（お互いに接続の準備をする）

   * ここでプロトコルの説明で出てきたTCPが登場します。

   * クライアントのブラウザがサーバに接続する準備が整ったら、お互いに接続の確認を行います。

   * これにより、データを安全に送る準備が整います。

1. データの送受信（実際に通信が始まる）

   * 接続が完了すると、クライアントとサーバはデータをやり取りします。

   * クライアントは動的に割り当てられた番号（例えば49152番）を使い、サーバは常にポート番号「80番」でデータを受け取り、サーバからのデータはそのクライアントの動的ポート番号（例えば49152番）に返送されます。

   * これで、クライアント（私たちのブラウザ）は、サーバから送られたデータを受け取り、WEBページを表示します。

1. 通信が終わったら終了

   * すべてのデータのやり取りが終わったら、接続を終了します。

<details> <summary>ネットワークのセキュリティ（ポート番号を守る）</summary>
インターネットを使うとき、私たちのコンピュータやスマートフォンは、他のコンピュータとデータをやり取りしています。このとき、「ポート番号」がどの「ドア」を使うかを決めています。でも、もし誰かが不正に侵入しようとしたら、その「ドア」が開いてしまうと危険です。

ここで登場するのが、**「ファイアウォール」や「ルーター」**というセキュリティの仕組みです。ネットワークの「守衛」のようなものです。ファイアウォールやルーターは、ポート番号をチェックして、正しい通信だけを通すようにしています。

例えば、ウェブサイトを開こうとすると、ブラウザ（インターネットを使うためのアプリ）が「ポート80」を使ってサーバーに接続します。このとき、もし悪意のある攻撃者が不正に別のポートを使ってアクセスしようとした場合、セキュリティシステムがそのポートを「閉じて」通さないようにします。こうすることで、私たちのデータやコンピュータが守られるわけです。

要するに、ファイアウォールやルーターは、ポートを監視して、悪いアクセスを防ぐ「警備員」のような役割を果たしているんですね。

</details>

***

## 次に、HTTPプロトコルを実際に触れて学んでみましょう！

**初めに**、サーバーとクライアントの関係でも触れましたが、<u>普段私たちはウェブページを閲覧するときクライアント側(私たち)から送信されたリクエストをサーバーがレスポンスとして返す一連の流れがあります。</u>  

ブラウザで実際にHTTPリクエストを送信し、レスポンスを確認する方法にはいくつかの方法があります。  
ここでは、ブラウザの開発者ツールを使う方法と、curlコマンドを使う方法を説明します。

### 1. ブラウザの開発者ツールを使ってHTTPリクエストを確認する
**ほとんどのモダンなブラウザ（Chrome、Edgeなど）には開発者ツールが組み込まれており、これを使ってHTTPリクエストとレスポンスを確認することができます**。

ブラウザでの手順   
 https://httpbin.org を開いてください。

1. 【開発者ツールを開く】
   - ブラウザで、右上の「メニュー（三点アイコン）」をクリックし、「その他のツール」>「(Chromeならデベロッパーツール)/(Edgeなら開発者ツール)」を選択する。  

   - キーボードショートカット（Ctrl+Shift+I または F12）を押して開きます。


2. 【「ネットワーク」タブに切り替える】  
   - 開発者ツール内で「Network（ネットワーク）」タブを選択します。  

   - このタブは、ブラウザが送受信しているすべてのHTTPリクエストとレスポンスを表示します。

3. 【ウェブページをリロードする】  
   - ネットワークタブが表示されている状態で、ブラウザのページをリロード（Ctrl+R）か左上のリロードボタン押します。

   - ページのロードが始まると、ネットワークタブにリクエストがリストされます。

4. 【リクエストを確認する】  
   - 表示されたリストの中から、ウェブページに関連するHTTPリクエスト（例えば、GET /index.html など）をクリックします。

   - 詳細情報が表示され、リクエストヘッダー、レスポンスヘッダー、レスポンスのボディ（HTML、画像、JSONデータなど）を見ることができます。

5. 【リクエストの詳細を確認する】  

   - Headers（ヘッダー）タブ：リクエストとレスポンスのヘッダー情報（例：User-Agent, Accept, Content-Typeなど）を確認できます。

   - Preview（プレビュー）タブ：レスポンスの内容が表示されます（HTMLページ、画像、JSONなど）。

### 2. curlコマンドを使ってHTTPリクエストを送る
**curlはコマンドでHTTPリクエストを送信するためのツールで、リクエストとレスポンスを簡単に確認できます**。

1. 【使い方 curlのインストール】  

   - curlは多くのLinux、macOS、Windows（最近では標準でインストールされています）に最初からインストールされています。

   - インストールされていない場合は、公式サイトからダウンロードすることができます。

1. 【コマンドプロンプトを開く】  
   - スタートメニュー（画面左下のWindowsアイコン）をクリックします。  

   - 「cmd」と入力します。  

   - 「コマンドプロンプト」または「Command Prompt」が表示されたら、クリックして開きます。

1. 【リクエスト】  

  - 以下のコマンドを使って、指定したURLにリクエストを送信できます。
    ```
    bash

    curl https://httpbin.org
    ```
    これで、https://httpbin.org のレスポンス（HTMLなど）が表示されます。

4. 【リクエストとレスポンス】

  - リクエストやレスポンスを確認するには、`curl -v`を使います。
    ```
    curl -v https://httpbin.org 
    ```
    このコマンドを実行すると、以下のような情報が処理の上部に表示されます。

    ```
    ##リクエスト

    GET / HTTP/2
    Host: httpbin.org
    user-agent: curl/7.81.0
    accept: */*
    
    ```

    * `GET / HTTP/2: GET`は「情報を取得したい」というリクエストを意味します。/は、サーバー上のトップページを意味しています。  

    * `Host: httpbin.org:` どのサーバーにリクエストを送るかを示しています。  

    * `user-agent: curl/7.81.0:` このリクエストがどのソフトウェア（この場合はcurl）から来たかを示しています。  
    
    * `accept: /:` サーバーが返す内容の形式（HTMLやJSONなど）を指定しています。

     <br>

    ```
    
      ##レスポンス

      HTTP/2 200
      date: Fri, 17 Jan 2025 07:04:30 GMT
      content-type: text/html; charset=utf-8
      content-length: 9593
      server: gunicorn/19.9.0
      access-control-allow-origin: *
      access-control-allow-credentials: true  

      ////以下(html)

    ```

    * `HTTP/2 200: HTTP/2`は使用されているプロトコルのバージョン、200はリクエストが正常に処理されたことを示すステータスコードです（200は「成功」を意味します）。  
      
    * `date: Fri, 17 Jan 2025 07:04:30 GMT:` サーバーがレスポンスを返した日時。  
      
    * `content-type: text/html; charset=utf-8:` レスポンスがHTML形式であること、文字コードがUTF-8であることを示しています。  
      
    * `content-length: 9593:` レスポンスの本文（ウェブページ）の長さを示します（バイト数）。  
      
    * `server: gunicorn/19.9.0:` このサーバーがどのソフトウェアを使用しているかを示しています。  

<br>


   5. 【レスポンスの詳細表示】<br>
   - -v（verbose）オプションを使うと、リクエストとレスポンスの詳細なログが表示されます。

      ```
      curl -v https://httpbin.org 

      ```

     **詳細なリクエストとレスポンスの流れ（HTTPヘッダー(リクエストとレスポンス)、ステータスコード、データ）を確認することができます。**

**このように、リクエストとレスポンスの内容を確認することができ、実際にどのように情報がやりとりされているのかを確認することができます。**

### **これらの手段を活用することで、HTTPリクエストとレスポンスの詳細を視覚的に確認できます。**

- <u>ブラウザの開発者ツール</u>を使ってHTTPリクエストとレスポンスを視覚的に確認できます。  

- <u>curlコマンド</u>を使うことで、コマンドラインからリクエストを送信し、レスポンスをシンプルに確認できます。ヘッダーやステータスコード、レスポンスの内容なども確認できます。
   
***


